<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SA-MP - Payments</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0a1a3c;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .form-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 12px;
            width: 95%;
            max-width: 450px;
            backdrop-filter: blur(10px);
        }

        .form-container h2 {
            text-align: center;
            margin-bottom: 20px;
        }

        label {
            font-weight: 600;
            margin-top: 10px;
            display: block;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            margin-top: 8px;
            border-radius: 8px;
            border: none;
            outline: none;
        }

        textarea {
            resize: none;
            height: 100px;
        }

        button {
            width: 100%;
            padding: 12px;
            background: black;
            border: none;
            color: white;
            font-size: 16px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            transition: 0.3s;
        }
        button:hover {
            background: darkblue;
        }

        .btn-kembali {
        display: block;
        width: 100%;
        padding: 12px;
        margin-top: 12px;
        background: #1e88ff;
        color: white;
        text-align: center;
        border-radius: 8px;
        font-weight: bold;
        text-decoration: none;
        transition: 0.3s;
        }

        .btn-kembali:hover {
            background: #0d6cd6;
        }

    </style>
</head>
<body>

    <div class="form-container"><h2>Form Pembayaran & Order</h2>

<label>Nama</label>
<input type="text" id="nama" placeholder="Masukkan nama kamu">

<label>Email</label>
<input type="email" id="email" placeholder="Masukkan email kamu">

<label>Pilih Layanan</label>
<select id="layanan">
    <option value="Scripting Pawn">Scripting Pawn</option>
    <option value="Mapping">Mapping</option>
    <option value="Textdraw">Textdraw</option>
    <option value="Fix Bug">Fix Bug</option>
</select>

<label>Upload Foto (Opsional)</label>
<input type="file" id="foto" accept="image/*" onchange="previewFoto()">

<img id="preview" style="display:none; width:100%; margin-top:10px; border-radius:8px;">

<label>Deskripsi Order</label>
<textarea id="deskripsi" placeholder="Tulis orderan kamu secara detail..."></textarea>

<button onclick="kirimData()">Kirim Order</button>
<a href="index.html" class="btn-kembali">Kembali</a>

    </div>

<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
  emailjs.init({
    publicKey: "wVNA4b9j45kVeS3yb"
  });

  function previewFoto() {
      let file = document.getElementById("foto").files[0];
      let preview = document.getElementById("preview");

      if (file) {
          preview.src = URL.createObjectURL(file);
          preview.style.display = "block";
      } else {
          preview.style.display = "none";
      }
  }

  async function kirimData() {
      let nama = document.getElementById("nama").value;
      let email = document.getElementById("email").value;
      let layanan = document.getElementById("layanan").value;
      let deskripsi = document.getElementById("deskripsi").value;
      let fotoFile = document.getElementById("foto").files[0];

      if(nama.trim() === "" || email.trim() === "" || deskripsi.trim() === "") {
        alert("Semua data wajib diisi kecuali foto!");
        return;
      }

      let fotoURL = "Tidak ada foto yang dikirim";

      if (fotoFile) {
        let formData = new FormData();
        formData.append("image", fotoFile);

        try {
          let upload = await fetch("https://api.imgbb.com/1/upload?key=5c9475cec4799ade8b36dffc5898ba13", {
              method: "POST",
              body: formData,
          });
          let result = await upload.json();
          if (result && result.data && result.data.url) {
            fotoURL = result.data.url;
          }
        } catch (e) {
          console.error("Upload foto gagal:", e);
        }
      }

      try {
        await emailjs.send("service_rw9nz2n", "template_akw5xxb", {
          name: nama,
          email: email,
          layanan: layanan,
          message: deskripsi,
          foto: fotoURL,
          time: new Date().toLocaleString()
        });
        alert("Order berhasil dikirim ke Email!");
      } catch (error) {
        alert("Gagal mengirim email: " + (error?.status || "") + " ‚Äì " + (error?.text || error));
        console.error("EmailJS Error:", error);
      }

      let phone = "6283803770518";
      let message =
          "üìå *Order Baru*\n\n" +
          "üë§ Nama: " + nama + "\n" +
          "üìß Email: " + email + "\n" +
          "üõí Layanan: " + layanan + "\n" +
          "üìù Deskripsi:\n" + deskripsi;

      window.open("https://wa.me/" + phone + "?text=" + encodeURIComponent(message), "_blank");
  }
</script>
</body>
</html>

